import { Oyuncu } from './class/oyuncu.js';
import { Functions } from './class/utils.js';
import { Kontroller } from './class/kontroller.js';

class Oyun {
  constructor(width,height) {
    this.fps = 25;
    this.width = width;
    this.height = height;
    this.oyuncu = new Oyuncu(this);
    this.kontroller = new Kontroller();
  }

  guncelle() {
    this.oyuncu.guncelle(this.kontroller.tuslar);
  }

  ciz(context) {
     this.oyuncu.ciz(context);
  }

}

const f = new Functions(),
  canvas = f.gid('myCanvas1'),
  context = canvas.getContext('2d');

var canvasHeight = 400,
  canvasWidth = canvasHeight * 3,
  sayac = 0,
  oyun = null,
  oyuncuAnimasyonu = null;

const baslangic = async () => {
  canvas.width = canvasWidth;
  canvas.height = canvasHeight;
  oyun = new Oyun(canvas.width,canvas.height);
  oyuncuAnimasyonu = setInterval(()=>{
    const seviyeler = [ 6, 6, 6, 8, 10, 4, 6, 6, 11, 3 ]
    oyun.oyuncu.cerceveAnimasyonKaresi = oyun.oyuncu.cerceveAnimasyonKaresi + 1 <= seviyeler[oyun.oyuncu.cerceveDurumu] ? oyun.oyuncu.cerceveAnimasyonKaresi+1 : 0
  },1000 / oyun.fps)
  animayson();
}

const intervalBaslat = (degisken, fonksiyon, sure) => degisken = setInterval(() => { fonksiyon(); }, sure * 1000);

const invertalDurdur = ( degisken ) => {
  clearInterval(degisken);
  degisken = null;
}

const animayson = async () => {
  context.clearRect(0, 0, canvas.width, canvas.height);
  oyun.guncelle();
  oyun.ciz(context);
  requestAnimationFrame(animayson)
}

window.onload = baslangic();